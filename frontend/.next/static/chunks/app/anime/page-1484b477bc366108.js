(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{8910:function(e,a,t){Promise.resolve().then(t.bind(t,9386))},9386:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return c}});var r=t(7437),s=t(2265),n=t(4033),l=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,l.Z)("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);var o=t(6454),d=t(1387);function c(){let e=(0,n.useSearchParams)(),[a,t]=(0,s.useState)([]),[l,c]=(0,s.useState)([]),[g,u]=(0,s.useState)(!0),[x,m]=(0,s.useState)(""),[p,h]=(0,s.useState)({page:1,total:0,pages:0,limit:24}),[y,b]=(0,s.useState)({genre:e.get("genre")||"",year:e.get("year")||"",status:e.get("status")||"",sort:e.get("sort")||"popularity"}),[f,v]=(0,s.useState)(!1);(0,s.useEffect)(()=>{j()},[]),(0,s.useEffect)(()=>{w()},[y,p.page]);let j=async()=>{try{let e=await o.JF.getGenres();c(e)}catch(e){console.error("Error loading genres:",e)}},w=async()=>{u(!0);try{let e={page:p.page,limit:p.limit,sort:y.sort};y.genre&&(e.genre=y.genre),y.year&&(e.year=parseInt(y.year)),y.status&&(e.status=y.status);let a=await o.JF.getList(e);t(a.data),h(e=>({...e,total:a.total,pages:a.pages})),m("")}catch(e){console.error("Error loading anime:",e),m("Не удалось загрузить аниме")}finally{u(!1)}},N=(e,a)=>{b(t=>({...t,[e]:a})),h(e=>({...e,page:1}))},k=e=>{h(a=>({...a,page:e})),window.scrollTo({top:0,behavior:"smooth"})},E=new Date().getFullYear(),_=Array.from({length:30},(e,a)=>E-a);return(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Каталог аниме"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:p.total>0?"Найдено ".concat(p.total," аниме"):"Загрузка..."})]}),(0,r.jsx)("div",{className:"flex items-center space-x-4 mt-4 md:mt-0",children:(0,r.jsxs)("button",{onClick:()=>v(!f),className:"flex items-center space-x-2 px-4 py-2 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:[(0,r.jsx)(i,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:"Фильтры"})]})})]}),f&&(0,r.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-8",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Жанр"}),(0,r.jsxs)("select",{value:y.genre,onChange:e=>N("genre",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-anime-purple dark:bg-gray-700 dark:text-white",children:[(0,r.jsx)("option",{value:"",children:"Все жанры"}),l.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Год"}),(0,r.jsxs)("select",{value:y.year,onChange:e=>N("year",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-anime-purple dark:bg-gray-700 dark:text-white",children:[(0,r.jsx)("option",{value:"",children:"Любой год"}),_.map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Статус"}),(0,r.jsxs)("select",{value:y.status,onChange:e=>N("status",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-anime-purple dark:bg-gray-700 dark:text-white",children:[(0,r.jsx)("option",{value:"",children:"Любой статус"}),(0,r.jsx)("option",{value:"FINISHED",children:"Завершено"}),(0,r.jsx)("option",{value:"RELEASING",children:"Выходит"}),(0,r.jsx)("option",{value:"NOT_YET_RELEASED",children:"Анонс"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Сортировка"}),(0,r.jsxs)("select",{value:y.sort,onChange:e=>N("sort",e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-anime-purple dark:bg-gray-700 dark:text-white",children:[(0,r.jsx)("option",{value:"popularity",children:"По популярности"}),(0,r.jsx)("option",{value:"score",children:"По рейтингу"}),(0,r.jsx)("option",{value:"year",children:"По году"}),(0,r.jsx)("option",{value:"title",children:"По названию"})]})]})]})}),(0,r.jsx)(d.Z,{anime:a,loading:g,error:x}),p.pages>1&&(0,r.jsx)("div",{className:"flex justify-center mt-12",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>k(p.page-1),disabled:1===p.page,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700",children:"Назад"}),Array.from({length:Math.min(5,p.pages)},(e,a)=>{let t=Math.max(1,p.page-2)+a;return t>p.pages?null:(0,r.jsx)("button",{onClick:()=>k(t),className:"px-3 py-2 text-sm font-medium rounded-lg ".concat(t===p.page?"bg-anime-purple text-white":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700"),children:t},t)}),(0,r.jsx)("button",{onClick:()=>k(p.page+1),disabled:p.page===p.pages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700",children:"Вперед"})]})})]})}},1387:function(e,a,t){"use strict";t.d(a,{Z:function(){return m}});var r=t(7437),s=t(6691),n=t.n(s),l=t(1396),i=t.n(l),o=t(4900),d=t(5340),c=t(8203);function g(e){let{anime:a}=e;return(0,r.jsxs)("div",{className:"anime-card group overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative aspect-[3/4] overflow-hidden",children:[a.cover_image?(0,r.jsx)(n(),{src:a.cover_image,alt:a.title_romaji,fill:!0,className:"object-cover group-hover:scale-110 transition-transform duration-300",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-anime-purple to-anime-pink flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-4xl font-bold",children:a.title_romaji.charAt(0)})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 flex items-center justify-center",children:(0,r.jsx)(i(),{href:"/anime/".concat(a.id),children:(0,r.jsx)("button",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white text-gray-900 p-3 rounded-full hover:bg-gray-100",children:(0,r.jsx)(o.Z,{className:"h-6 w-6"})})})}),a.status&&(0,r.jsx)("div",{className:"absolute top-2 left-2",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"FINISHED":return"bg-green-100 text-green-800";case"RELEASING":return"bg-blue-100 text-blue-800";case"NOT_YET_RELEASED":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(a.status)),children:(e=>{switch(e){case"FINISHED":return"Завершено";case"RELEASING":return"Выходит";case"NOT_YET_RELEASED":return"Анонс";default:return"Неизвестно"}})(a.status)})}),a.average_score&&(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded-full flex items-center space-x-1",children:[(0,r.jsx)(d.Z,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:(a.average_score/10).toFixed(1)})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)(i(),{href:"/anime/".concat(a.id),children:(0,r.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2 hover:text-anime-purple transition-colors",children:a.title_english||a.title_romaji})}),a.genres&&a.genres.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[a.genres.slice(0,3).map(e=>(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded",children:e.name},e.id)),a.genres.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded",children:["+",a.genres.length-3]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:a.season_year||"N/A"})]}),a.episodes&&(0,r.jsxs)("span",{children:[a.episodes," эп."]})]}),a.studios&&a.studios.length>0&&(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:a.studios[0].name})]})]})}var u=t(2898);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,u.Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function m(e){let{anime:a,loading:t,error:s}=e;return t?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)(x,{className:"h-8 w-8 animate-spin text-anime-purple"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Загрузка аниме..."})]}):s?(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Ошибка загрузки"}),(0,r.jsx)("p",{className:"text-red-600",children:s})]})}):a&&0!==a.length?(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:a.map(e=>(0,r.jsx)(g,{anime:e},e.id))}):(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 max-w-md mx-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Аниме не найдено"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Попробуйте изменить параметры поиска"})]})})}},6454:function(e,a,t){"use strict";t.d(a,{DN:function(){return o},JF:function(){return i},c4:function(){return c},iJ:function(){return d}});var r=t(4829),s=t(2601);let n=s.env.NEXT_PUBLIC_API_URL||"http://localhost:8000",l=r.Z.create({baseURL:n,timeout:1e4,headers:{"Content-Type":"application/json"}});l.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),l.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)});let i={getList:async e=>{let a=await l.get("/api/v1/anime/",{params:e});return a.data},getDetail:async e=>{let a=await l.get("/api/v1/anime/".concat(e));return a.data},search:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,t=await l.get("/api/v1/anime/search",{params:{q:e,limit:a}});return t.data},getGenres:async()=>{let e=await l.get("/api/v1/anime/genres/");return e.data},getStudios:async()=>{let e=await l.get("/api/v1/anime/studios/");return e.data}},o={getByAnime:async e=>{let a=await l.get("/api/v1/episodes/anime/".concat(e));return a.data},getDetail:async e=>{let a=await l.get("/api/v1/episodes/".concat(e));return a.data},getSources:async e=>{let a=await l.get("/api/v1/episodes/".concat(e,"/sources"));return a.data},saveProgress:async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await l.post("/api/v1/episodes/".concat(e,"/progress"),{progress:a,completed:t})}},d={register:async e=>{let a=await l.post("/api/v1/auth/register",e);return a.data},login:async e=>{let a=new FormData;a.append("username",e.username),a.append("password",e.password);let t=await l.post("/api/v1/auth/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return t.data},refresh:async()=>{let e=await l.post("/api/v1/auth/refresh");return e.data}},c=async()=>{let e=await l.get("/health");return e.data}},4033:function(e,a,t){e.exports=t(94)}},function(e){e.O(0,[77,396,73,971,472,744],function(){return e(e.s=8910)}),_N_E=e.O()}]);