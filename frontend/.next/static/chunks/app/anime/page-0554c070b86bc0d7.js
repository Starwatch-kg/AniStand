(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[604],{638:function(e,a,t){Promise.resolve().then(t.bind(t,2883))},3247:function(e,a,t){"use strict";t.d(a,{Z:function(){return r}});let r=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},9376:function(e,a,t){"use strict";var r=t(5475);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},2883:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return d}});var r=t(7437),s=t(2265),n=t(9376),i=t(1837),l=t(8413),c=t(3247);function o(){(0,n.useSearchParams)();let[e,a]=(0,s.useState)([]),[t,o]=(0,s.useState)([]),[d,u]=(0,s.useState)(!0),[g,x]=(0,s.useState)(""),[p,m]=(0,s.useState)({page:1,total:0,pages:0,limit:24}),[h,y]=(0,s.useState)({search:"",genre:"",year:"",status:"",sort:"popularity"});(0,s.useEffect)(()=>{b()},[]),(0,s.useEffect)(()=>{v()},[h,p.page]);let b=async()=>{try{let e=await i.JF.getGenres();o(e)}catch(e){console.error("Ошибка загрузки жанров:",e)}},v=async()=>{try{u(!0),x("");let e={page:p.page,limit:p.limit,search:h.search||void 0,genre:h.genre||void 0,year:h.year?parseInt(h.year):void 0,status:h.status||void 0,sort:h.sort},t=await i.JF.getList(e);a(t.data||[]),m(e=>({...e,total:t.total||0,pages:t.pages||0}))}catch(e){console.error("Ошибка загрузки аниме:",e),x("Не удалось загрузить каталог аниме")}finally{u(!1)}},f=(e,a)=>{y(t=>({...t,[e]:a})),m(e=>({...e,page:1}))},j=e=>{m(a=>({...a,page:e})),window.scrollTo({top:0,behavior:"smooth"})};return g?(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"text-red-400 text-xl mb-4",children:g}),(0,r.jsx)("button",{onClick:v,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Попробовать снова"})]})}):(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 text-white",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent",children:"Каталог Аниме"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Найдите и смотрите любимые аниме онлайн"})]}),(0,r.jsx)("div",{className:"mb-8 bg-gray-800 rounded-lg p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,r.jsx)("div",{className:"lg:col-span-2",children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(c.Z,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),(0,r.jsx)("input",{type:"text",placeholder:"Поиск аниме...",value:h.search,onChange:e=>f("search",e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-purple-500"})]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:h.genre,onChange:e=>f("genre",e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-purple-500",children:[(0,r.jsx)("option",{value:"",children:"Все жанры"}),t.map(e=>(0,r.jsx)("option",{value:e.name,children:e.name},e.id))]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:h.year,onChange:e=>f("year",e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-purple-500",children:[(0,r.jsx)("option",{value:"",children:"Любой год"}),Array.from({length:30},(e,a)=>2024-a).map(e=>(0,r.jsx)("option",{value:e,children:e},e))]})}),(0,r.jsx)("div",{children:(0,r.jsxs)("select",{value:h.sort,onChange:e=>f("sort",e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg focus:outline-none focus:border-purple-500",children:[(0,r.jsx)("option",{value:"popularity",children:"Популярность"}),(0,r.jsx)("option",{value:"rating",children:"Рейтинг"}),(0,r.jsx)("option",{value:"year",children:"Год"}),(0,r.jsx)("option",{value:"title",children:"Название"})]})})]})}),d?(0,r.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"})}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"mb-6 text-gray-400",children:["Найдено ",p.total," аниме"]}),(0,r.jsx)(l.Z,{anime:e}),p.pages>1&&(0,r.jsx)("div",{className:"mt-12 flex justify-center",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>j(p.page-1),disabled:1===p.page,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700",children:"Назад"}),Array.from({length:Math.min(5,p.pages)},(e,a)=>{let t=Math.max(1,p.page-2)+a;return t>p.pages?null:(0,r.jsx)("button",{onClick:()=>j(t),className:"px-3 py-2 text-sm font-medium rounded-lg ".concat(t===p.page?"text-white bg-purple-600 border border-purple-600":"text-gray-500 bg-white border border-gray-300 hover:bg-gray-50 dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700"),children:t},t)}),(0,r.jsx)("button",{onClick:()=>j(p.page+1),disabled:p.page===p.pages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed dark:bg-gray-800 dark:border-gray-600 dark:text-gray-400 dark:hover:bg-gray-700",children:"Вперед"})]})})]})]})})}function d(){return(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:(0,r.jsx)("div",{className:"text-white text-xl",children:"Загрузка каталога..."})}),children:(0,r.jsx)(o,{})})}},8413:function(e,a,t){"use strict";t.d(a,{Z:function(){return u}});var r=t(7437),s=t(3145),n=t(7648),i=t(3276),l=t(6595),c=t(1047);function o(e){let{anime:a}=e;return(0,r.jsxs)("div",{className:"anime-card group overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative aspect-[3/4] overflow-hidden",children:[a.cover_image?(0,r.jsx)(s.default,{src:a.cover_image,alt:a.title_romaji,fill:!0,className:"object-cover group-hover:scale-110 transition-transform duration-300",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"}):(0,r.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-anime-purple to-anime-pink flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-4xl font-bold",children:a.title_romaji.charAt(0)})}),(0,r.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 transition-all duration-300 flex items-center justify-center",children:(0,r.jsx)(n.default,{href:"/anime/".concat(a.id),children:(0,r.jsx)("button",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white text-gray-900 p-3 rounded-full hover:bg-gray-100",children:(0,r.jsx)(i.Z,{className:"h-6 w-6"})})})}),a.status&&(0,r.jsx)("div",{className:"absolute top-2 left-2",children:(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((e=>{switch(e){case"FINISHED":return"bg-green-100 text-green-800";case"RELEASING":return"bg-blue-100 text-blue-800";case"NOT_YET_RELEASED":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(a.status)),children:(e=>{switch(e){case"FINISHED":return"Завершено";case"RELEASING":return"Выходит";case"NOT_YET_RELEASED":return"Анонс";default:return"Неизвестно"}})(a.status)})}),a.average_score&&(0,r.jsxs)("div",{className:"absolute top-2 right-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded-full flex items-center space-x-1",children:[(0,r.jsx)(l.Z,{className:"h-3 w-3 fill-yellow-400 text-yellow-400"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:(a.average_score/10).toFixed(1)})]})]}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)(n.default,{href:"/anime/".concat(a.id),children:(0,r.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-2 line-clamp-2 hover:text-anime-purple transition-colors",children:a.title_english||a.title_romaji})}),a.genres&&a.genres.length>0&&(0,r.jsxs)("div",{className:"flex flex-wrap gap-1 mb-2",children:[a.genres.slice(0,3).map(e=>(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded",children:e.name},e.id)),a.genres.length>3&&(0,r.jsxs)("span",{className:"px-2 py-1 text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded",children:["+",a.genres.length-3]})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500 dark:text-gray-400",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:a.season_year||"N/A"})]}),a.episodes&&(0,r.jsxs)("span",{children:[a.episodes," эп."]})]}),a.studios&&a.studios.length>0&&(0,r.jsx)("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:a.studios[0].name})]})]})}let d=(0,t(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);function u(e){let{anime:a,loading:t,error:s}=e;return t?(0,r.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,r.jsx)(d,{className:"h-8 w-8 animate-spin text-anime-purple"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Загрузка аниме..."})]}):s?(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md mx-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-red-800 mb-2",children:"Ошибка загрузки"}),(0,r.jsx)("p",{className:"text-red-600",children:s})]})}):a&&0!==a.length?(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 md:gap-6",children:a.map(e=>(0,r.jsx)(o,{anime:e},e.id))}):(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 max-w-md mx-auto",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Аниме не найдено"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Попробуйте изменить параметры поиска"})]})})}},1837:function(e,a,t){"use strict";t.d(a,{DN:function(){return l},JF:function(){return i},c4:function(){return o},iJ:function(){return c}});var r=t(3464);let s=t(257).env.NEXT_PUBLIC_API_URL||"http://localhost:8000",n=r.Z.create({baseURL:s,timeout:1e4,headers:{"Content-Type":"application/json"}});n.interceptors.request.use(e=>{let a=localStorage.getItem("token");return a&&(e.headers.Authorization="Bearer ".concat(a)),e}),n.interceptors.response.use(e=>e,e=>{var a;return(null===(a=e.response)||void 0===a?void 0:a.status)===401&&(localStorage.removeItem("token"),window.location.href="/auth/login"),Promise.reject(e)});let i={getList:async e=>(await n.get("/api/v1/anime/",{params:e})).data,getDetail:async e=>(await n.get("/api/v1/anime/".concat(e))).data,search:async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return(await n.get("/api/v1/anime/search",{params:{q:e,limit:a}})).data},getGenres:async()=>(await n.get("/api/v1/anime/genres/")).data,getStudios:async()=>(await n.get("/api/v1/anime/studios/")).data},l={getByAnime:async e=>(await n.get("/api/v1/episodes/anime/".concat(e))).data,getDetail:async e=>(await n.get("/api/v1/episodes/".concat(e))).data,getSources:async e=>(await n.get("/api/v1/episodes/".concat(e,"/sources"))).data,saveProgress:async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];await n.post("/api/v1/episodes/".concat(e,"/progress"),{progress:a,completed:t})}},c={register:async e=>(await n.post("/api/v1/auth/register",e)).data,login:async e=>{let a=new FormData;return a.append("username",e.username),a.append("password",e.password),(await n.post("/api/v1/auth/login",a,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data},refresh:async()=>(await n.post("/api/v1/auth/refresh")).data},o=async()=>(await n.get("/health")).data}},function(e){e.O(0,[992,648,108,971,117,744],function(){return e(e.s=638)}),_N_E=e.O()}]);